#!/bin/sh

export JAVA_OPTS=" ${JAVA_OPTS} -server"
export JAVA_OPTS=" ${JAVA_OPTS} -DjvmRoute=tomwas"
export JAVA_OPTS=" ${JAVA_OPTS} -Dport.http={{ tomcat.port.http }}"
export JAVA_OPTS=" ${JAVA_OPTS} -Dport.https={{ tomcat.port.https }}"
export JAVA_OPTS=" ${JAVA_OPTS} -Dport.ajp={{ tomcat.port.ajp }}"
export JAVA_OPTS=" ${JAVA_OPTS} -Dport.shutdown={{ tomcat.port.shutdown }}"
export JAVA_OPTS=" ${JAVA_OPTS} -Djava.security.egd=file:/dev/./urandom"
export JAVA_OPTS=" ${JAVA_OPTS} -Djava.library.path=/opt/apr/lib"

#export JMX_OPTS=" -Dcom.sun.management.jmxremote \
#                 -Dcom.sun.management.jmxremote.port=8190 \
#                 -Dcom.sun.management.jmxremote.authenticate=false \
#                 -Djava.rmi.server.hostname=192.168.96.20 \
#                -Dcom.sun.management.jmxremote.ssl=false "

#export MEM_OPTS="-Xms4G -Xmx4G -XX:PermSize=256m -XX:MaxPermSize=256m"
# ParallelGC
export CATALINA_OPTS=" ${CATALINA_OPTS} -XX:NewRatio=3"
export CATALINA_OPTS=" ${CATALINA_OPTS} -XX:+DisableExplicitGC"
export CATALINA_OPTS=" ${CATALINA_OPTS} -XX:+HeapDumpOnOutOfMemoryError"
export CATALINA_OPTS=" ${CATALINA_OPTS} -XX:HeapDumpPath=/home/${INSTANCE_OWNER}/tomcat/logs/heap.data"
export CATALINA_OPTS=" ${CATALINA_OPTS} -verbosegc -XX:+PrintGCDetails -XX:+PrintGCTimeStamps"
export CATALINA_OPTS=" ${CATALINA_OPTS} -Xloggc:/home/${INSTANCE_OWNER}/tomcat/logs/gc_`date "+%Y%m%d%H"`.log"
export CATALINA_OPTS=" ${CATALINA_OPTS} -XX:+UseGCLogFileRotation -XX:NumberOfGCLogFiles=10 -XX:GCLogFileSize=50m"

# CMS GC
#export JVM_OPTS="-XX:NewRatio=7 -XX:+UseParNewGC -XX:+UseConcMarkSweepGC -XX:+CMSParallelRemarkEnabled -XX:CMSInitiatingOccupancyFraction=75 -XX:+UseCMSInitiatingOccupancyOnly -XX:CMSFullGCsBeforeCompaction=0 -XX:+DisableExplicitGC -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/home/${INSTANCE_OWNER}/logs -verbosegc -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -Xloggc:/home/${INSTANCE_OWNER}/logs/gc_`date "+%Y%m%d%H"`.log -Djava.security.egd=file:/dev/./urandom"

# G1
# export JVM_OPTS="-XX:+UseG1GC -XX:+UnlockDiagnosticVMOptions -XX:+G1SummarizeConcMark -XX:+PrintFlagsFinal -XX:+PrintReferenceGC -verbose:gc -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:+PrintAdaptiveSizePolicy -XX:+DisableExplicitGC -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/home/${INSTANCE_OWNER}/logs -verbosegc -Xloggc:/home/${INSTANCE_OWNER}/logs/gc_`date "+%Y%m%d%H"`.log -Djava.security.egd=file:/dev/./urandom"