---
# Granting write access to this directory for non-privileged users could provide
# them the means for gaining unauthorized elevated privileges.
# Granting read access to this directory could give an unprivileged user insight
# in how to gain elevated privileges or circumvent auditing controls.
# CIS 5.1.2 - CIS 5.1.7
#
- name: Find cron files and directories
  find:
    paths:
      - /etc
    patterns:
      - cron.hourly     # original 0755
      - cron.daily      # original 0755
      - cron.weekly     # original 0755
      - cron.monthly    # original 0755
      - cron.d          # original 0755
      - crontab         # original 0644
      - cron.deny       # original 0644
      - cron.allow
    file_type: any
  register: cron_directories

- name: Ensure permissions on cron files and directories are configured
  ansible.builtin.file:
    path: "{{ item.path }}"
    owner: root
    group: root
    mode: 0640
  with_items: "{{ cron_directories.files }}"