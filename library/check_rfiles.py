#!/usr/bin/python
# -*- coding: utf-8 -*-

from ansible.module_utils.basic import *
import os.path

if __name__ == '__main__':
    argument_spec = dict(
        home_dir = dict(required=True, type='str'),
        rfiles = dict(required=True, type='list'),
    )
    module = AnsibleModule(argument_spec=argument_spec, supports_check_mode=True)
    result = { "changed": False}
    home_dir = module.params["home_dir"]
    rfiles = module.params["rfiles"]

    msg_dic = {"rfiles": ""}
    rfiles_list = []

    for rfile in rfiles:
        res = os.path.isfile("%s/%s" % (home_dir, rfile))
        if res is False:
            rfiles_list.append("%s/%s doesn't exits" % (home_dir, rfile))
        else:
            result['failed'] = True
            rfiles_list.append("%s/%s does exits" % (home_dir, rfile))

    msg_dic['rfiles'] = rfiles_list
    result['msg'] = msg_dic

    if result.get('failed'):
        module.fail_json(**result)
    else:
        module.exit_json(**result)